---
title: Blender Addon 建图工具 开发日志
date: 2021-03-11 15:22:53
tags:
---



## 第一次Demo视频演示总结 (03-11)

视频建议：

1. 演示用词更加规范
2. 逻辑性需要加强，可以按照“绘制的道路类型（直线，曲线，单双车道等)-- 车道编辑 -- 物体放置” 这样的顺序组织。
3. 场景丰富度需要增加，比如放一排树之类的。

待解决Bugs：

1. 重复点击新建道路后会由于Operator状态未清空生成新的Mesh -- 可考虑使用SceneRecord作为状态指示
2. 交通锥等导入模型由于Origin未调整导致部分模型陷入道路表面下
3. 绿化带时不时无法生成 -- 可能是Road Mesh生成函数的检查条件导致

待实现features:

  和 2021-03-01 计划的一致，另有增加：

- [ ] 道路的z轴方向坡度调整





## 当前进度和计划更新（2021-03-01）

演示视频前需要的改进处：

- [ ] 点击道路mesh生成边界线curve，然后自动选中curve，点击导入在curve上自动import Object并绑定


​																								点击“多个”自动铺满，并可以调间距，范围

- [ ] **新建**时删除mesh，状态栏条目也删除（删除状态栏条目，mesh也删除）

- [ ] 导入图片

- [x] UI美化



通过Constraint绑定物体到曲线有一个问题，就是曲线的Origin必须要set to Geometry， 物体的Origin亦需要保持在一个接近其中心的位置，两者绑定前一刻的Origin相对关系似乎也有讲究，需要在之后总结记录。



## 计划中的操作、图形和数据的联动（2021-02-24）

昨天参考BlenderTodo插件做了一个类似状态窗的Panel，但是其除了视觉上让这个插件更“软件”化，想要进一步用他体现出（Road-lane-obj/roadmark的层级关系），或者同步对应于Mesh的增删查改功能，还是有比较多要解决的坑。

当前待完成的难点所在：

1. 通过Scene_record 记录操作对Mesh的影响并同步到状态Panel

2. 在Panel上每一条记录对应的Road给选中时，Panel对应条目高亮

   需要将Mesh操作和数据变动耦合起来，为此需要对：

   Mesh命名对象化，对象层级关系明确，对象数据和Scene_record绑定（建立结构），Scene_record 和 all_data & bpy.context.scene["all_data"]  三者关系理顺。

   方式一：重写import和delete函数

   

## 当前进度和计划更新（2021-02-22）

明日上班，整理一下当前的任务情况：

待完成：

- [x] **修改道路类型 (20mins)**

- [x] **命名道路(30mins)**

- [ ] ~~**拉出马路牙子(30mins)**~~


- [x] **剥离资源库(2h)**

- [x] 解决道路沿线放置bug(2h)

- [x] 多重放置功能 完善

- [x] UI总成 -- **设计（20mins）** -- **实现（1h）**

- [x] **“导出”功能按钮，“保存”和“加载”功能呈现 (20mins)**

- [ ] lane中间物体放置（停止线之类的）

- [ ] *高度调整

  **粗体**尽量明日完成

